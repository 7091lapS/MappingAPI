<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title></title>

<!-- Necessary scripts -->
    <script src="lib/jQuery/jquery-2.1.0.min.js"></script>
    <script src="lib/bootstrap/js/bootstrap.min.js"></script>
    <link rel="stylesheet" href="lib/bootstrap/css/bootstrap.css" />

    <link rel="stylesheet" href="content/css/default.css" />

<div id="header-script"> 
<!-- PublicaMundi API script -->
 <script src="lib/PublicaMundi/build/publicamundi.js" data-library="ol"></script> 
 </div>

<!-- OpenLayers Development scripts -->
<!--    <link rel="stylesheet" href=" lib/PublicaMundi/build/lib/ol/ol.css" />
    
    <script src="lib/PublicaMundi/ol3-latest/ol-debug.js" data-library=""></script> 
    <script src="lib/ol3-layerswitcher/src/ol3-layerswitcher.js" data-library=""></script> 
    <script src="lib/xmlToJson/xmlToJson.js" data-library=""></script> 
    <script src="lib/PublicaMundi/src/PublicaMundi.js" data-library=""></script> 
    <script src="lib/PublicaMundi/src/lib/ol/PublicaMundi.OpenLayers.js" data-library=""></script> 
    <script src="lib/PublicaMundi/src/Map.js" data-library=""></script> 
    <script src="lib/PublicaMundi/src/Layer.js" data-library=""></script> 
    <script src="lib/PublicaMundi/src/lib/ol/Map.js" data-library=""></script> 
    <script src="lib/PublicaMundi/src/lib/ol/Layer.GeoJson.js" data-library=""></script> 
    <script src="lib/PublicaMundi/src/lib/ol/Layer.KML.js" data-library=""></script> 
    <script src="lib/PublicaMundi/src/lib/ol/Layer.WMS.js" data-library=""></script> 
    <script src="lib/PublicaMundi/src/lib/ol/Layer.WFS.js" data-library=""></script> 
    <script src="lib/PublicaMundi/src/lib/ol/Layer.Tile.js" data-library=""></script> -->

    </head>
<body>
    <div id="popup"></div>
    <div id="map" class="map"></div>
</body>
<script id="common-script">
    PublicaMundi.noConflict();
            
    //Popup handling with Bootstrap
    var onFeatureClick = function(layer, features, coordinate) {
        if (features) {
            feature = features [0];
            }
        if (popup) {
            map.setOverlayPosition(popup, coordinate);
            $(document.getElementById('popup')).popover('destroy');

            var text;
            if (feature['name']) {
                text = feature['name'];
            }
            else if (layer._options.name === beaches._options.name){
                text = feature['PRELEV']
            }
            else {
                text = JSON.stringify(feature);
            }
            
            $(document.getElementById('popup')).popover({
                'placement' : 'top',
                'animation' : true,
                'html' : true,
                'content' : text
                }).attr('data-original-title');

            $(document.getElementById('popup')).popover('show');
            }
          };

    // Map initialization options
    var options = {
        target: 'map',
        center: [2548716, 4743375],
        zoom: 6,
        minZoom: 2,
        maxZoom: 18,
        layers: [
        {
            title: 'Open Street Maps',
            type: PublicaMundi.LayerType.TILE,
            url: 'http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png'
        }
        ]
    };

    var map, popup;
    var railway, beaches, theaters;

    PublicaMundi.ready(function () {
        
        //Initialize map with provided options
        map = PublicaMundi.map(options);

        //Initilize optional layer switcher
        map.setLayerControl();
        
        //Initialize popup handler
        popup = map.addOverlay(document.getElementById('popup'));
       
        $(document.getElementById('map')).click(function() { 
            $(document.getElementById('popup')).popover('destroy');
            });


        //Add layers
       
        // WMS Railway Layer
        railway = map.createLayer({
            title: 'Railway Network',
            name: 'railway',
            type: PublicaMundi.LayerType.WMS,
            url: 'http://geodata.gov.gr/geoserver/wms',
            params: { 'layers' : 'geodata.gov.gr:4f5c40cc-8329-4081-b596-8ad70019ef23', 
                  }
            });
     
        
        // WFS Blue flag beaches Layer (initially hidden)
        beaches = map.createLayer({
            title: 'Blue Flag Beaches',
            name: 'beaches',
            type: PublicaMundi.LayerType.WFS,
            click: onFeatureClick,
            visible: false,
            url: 'http://geodata.gov.gr/geoserver/wfs',
            params: {'layers' : 'geodata.gov.gr:db5fe471-d0a7-4fe1-ae5d-6999c6cc24f4' }
            });
       
        // KML Ancient theaters Layer
        theaters = map.createLayer({
            title: 'Ancient Theaters',
            name: 'theaters',
            type: PublicaMundi.LayerType.KML,
            click: onFeatureClick,
            url: 'data/kml/archaia_theatra.kml',
            });
        
        });
    
</script>
</html>
