<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title></title>

<!-- Necessary scripts -->
    <script src="lib/jQuery/jquery-2.1.0.min.js"></script>
    <script src="lib/bootstrap/js/bootstrap.min.js"></script>
    <link rel="stylesheet" href="lib/bootstrap/css/bootstrap.css" />

    <link rel="stylesheet" href="content/css/default.css" />
    
<!-- PublicaMundi API script -->
    <script src="lib/PublicaMundi/build/publicamundi.js" data-library=""></script> 


<!-- Leaflet Development scripts -->
<!-- <link rel="stylesheet" href="lib/PublicaMundi/Leaflet/leaflet.css" />
    
    <script src="lib/PublicaMundi/Leaflet/leaflet-src.js" data-library=""></script> 
    <script src="lib/togeojson/togeojson.js" data-library=""></script> 
    <script src="lib/PublicaMundi/src/PublicaMundi.js" data-library=""></script> 
    <script src="lib/PublicaMundi/src/lib/leaflet/PublicaMundi.Leaflet.js" data-library=""></script> 
    <script src="lib/PublicaMundi/src/Map.js" data-library=""></script> 
    <script src="lib/PublicaMundi/src/Layer.js" data-library=""></script> 
    <script src="lib/PublicaMundi/src/lib/leaflet/Map.js" data-library=""></script> 
    <script src="lib/PublicaMundi/src/lib/leaflet/Layer.GeoJson.js" data-library=""></script> 
    <script src="lib/PublicaMundi/src/lib/leaflet/Layer.KML.js" data-library=""></script> 
    <script src="lib/PublicaMundi/src/lib/leaflet/Layer.WMS.js" data-library=""></script> 
    <script src="lib/PublicaMundi/src/lib/leaflet/Layer.WFS.js" data-library=""></script> 
    <script src="lib/PublicaMundi/src/lib/leaflet/Layer.Tile.js" data-library=""></script>  -->

<!-- OpenLayers Development scripts -->
<!--    <link rel="stylesheet" href=" lib/PublicaMundi/build/lib/ol/ol.css" />
    
    <script src="lib/PublicaMundi/ol3-latest/ol-debug.js" data-library=""></script> 
    <script src="lib/ol3-layerswitcher/src/ol3-layerswitcher.js" data-library=""></script> 
    <script src="lib/xmlToJson/xmlToJson.js" data-library=""></script> 
    <script src="lib/PublicaMundi/src/PublicaMundi.js" data-library=""></script> 
    <script src="lib/PublicaMundi/src/lib/ol/PublicaMundi.OpenLayers.js" data-library=""></script> 
    <script src="lib/PublicaMundi/src/Map.js" data-library=""></script> 
    <script src="lib/PublicaMundi/src/Layer.js" data-library=""></script> 
    <script src="lib/PublicaMundi/src/lib/ol/Map.js" data-library=""></script> 
    <script src="lib/PublicaMundi/src/lib/ol/Layer.GeoJson.js" data-library=""></script> 
    <script src="lib/PublicaMundi/src/lib/ol/Layer.KML.js" data-library=""></script> 
    <script src="lib/PublicaMundi/src/lib/ol/Layer.WMS.js" data-library=""></script> 
    <script src="lib/PublicaMundi/src/lib/ol/Layer.WFS.js" data-library=""></script> 
    <script src="lib/PublicaMundi/src/lib/ol/Layer.Tile.js" data-library=""></script> -->

    </head>
<body>
    <div id="popup"></div>
    <div id="map" class="map"></div>
</body>
<script>
    PublicaMundi.noConflict();

    var popup;
    var onFeatureClick = function(features, pixel) {
        if (features) {
            feature = features [0];
            }
        if (popup) {
            var element = map.getOverlayElement(popup);
            map.setOverlayPosition(popup, pixel); 
            $(document.getElementById('popup')).popover('destroy');

            var text; 
            if (feature['name']) {
                text = feature['name'];
            }
            else {
                text = JSON.stringify(feature);
            }

            $(element).popover({
                'placement' : 'top',
                'animation' : true,
                'html' : true,
                'content' : text
                }).attr('data-original-title');

                $(element).popover('show');
            }
          };

    var options = {
        target: 'map',
        center: [-10939408.106956497, 4561776.910611016],
        zoom: 3,
        minZoom: 2,
        maxZoom: 18,
        layers: [
        {
            title: 'Open Street Maps',
            type: PublicaMundi.LayerType.TILE,
            url: 'http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png'
        }]
    };
    var map;
    PublicaMundi.ready(function () {
        map = PublicaMundi.map(options);

        map.setLayerControl(map.getLayers()[0]);
        popup = map.addOverlay(document.getElementById('popup'));
        
        $(document.getElementById('map')).click(function() { 
            $(document.getElementById('popup')).popover('destroy');
            });
        var bbox;
        
        // WMS Layer
        var blocks_layer = map.createLayer({
            title: 'USA Population',
            type: PublicaMundi.LayerType.WMS,
            url: 'http://demo.opengeo.org/geoserver/wms',
            params: { 'layers' : 'topp:states', 
                      'transparent':true 
                    }
        });

        // GeoJSON Layer
       var countries = map.createLayer({
            type: PublicaMundi.LayerType.GeoJSON,
            title: 'Countries',
            url: 'data/geojson/countries.geojson',
            click: onFeatureClick
            });
        
        // WFS Layer
        var lakes = map.createLayer({
            title: 'Lakes',
            type: PublicaMundi.LayerType.WFS,
            click: onFeatureClick,
            url: 'http://demo.opengeo.org/geoserver/wfs',
            params: { 'layers' : 'maps:ne_10m_lakes' }
            });
        //lakes.setLayerExtent();
        
        // KML Layer
        var earthquakes = map.createLayer({
            type: PublicaMundi.LayerType.KML,
            title: 'Earthquakes',
            url: 'data/kml/2012_Earthquakes_Mag5.kml',
            click: onFeatureClick
           });

        
           });
    
</script>
</html>
