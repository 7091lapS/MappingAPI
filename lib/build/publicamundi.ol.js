/* PublicaMundi Mapping API version 0.1.0 2014-10-27 */

!function(a,b){"use strict";"undefined"!=typeof b&&(b.define("PublicaMundi.OpenLayers"),b.OpenLayers.Framework="ol",b.registerFrameworkResolver(b.OpenLayers.Framework,function(){return b.isObject(ol)&&b.isFunction(ol.Map)?!0:!1}))}(window,PublicaMundi),function(a,b,c){"undefined"!=typeof b&&"undefined"!=typeof c&&(b.define("PublicaMundi.OpenLayers"),b.OpenLayers.Map=b.Class(b.Map,{initialize:function(a){if(b.Map.prototype.initialize.call(this,a),this._map=b.isClass("ol.Map")&&a instanceof c.Map?a:new c.Map({target:a.target,view:new c.View2D({projection:a.projection,center:a.center,zoom:a.zoom}),controls:c.control.defaults().extend([]),ol3Logo:!1}),this._clickHandlerMap=null,this._clickHandlerLayer=[],this._clickHandlerRegisteredLayers=[],"undefined"!=typeof a.layers&&b.isArray(a.layers))for(var d=0;d<a.layers.length;d++)this.createLayer(a.layers[d])},setCenter:function(a,c){this._map.getView().setCenter(b.isArray(a)?a:[a,c])},getCenter:function(){return this._map.getView().getCenter()},setZoom:function(a){this._map.getView().setZoom(a)},getZoom:function(){return this._map.getView().getZoom()},getProjection:function(){return this._map.getView().getProjection().getCode()},getTarget:function(){return this._map.getTarget()},addLayer:function(a){if(this._map.addLayer(a.getLayer()),b.isFunction(a.getOptions().click)&&(this._clickHandlerRegisteredLayers.push(a),this._clickHandlerLayer.push(a.getOptions().click),!b.isFunction(this._clickHandlerMap))){var c=this._clickHandlerRegisteredLayers,d=this._clickHandlerLayer;this._clickHandlerMap=function(a){for(var b=this._map.getEventPixel(a.originalEvent),e=[],f=function(a,b){if(b===c[g].getLayer()&&b.get("visible")===!0){for(var d={},f=a.getKeys(),h=a.getGeometryName(),i=0;i<f.length;i++)f[i]!==h&&(d[f[i]]=a.get(f[i]));e.push(d)}},g=0;g<c.length;g++)e=[],this._map.forEachFeatureAtPixel(b,f),e.length>0&&d[g](e)},this._map.on("singleclick",this._clickHandlerMap,this)}}}),b.locator.register("PublicaMundi.Map",b.OpenLayers.Map))}(window,window.PublicaMundi,ol),function(a,b,c){"undefined"!=typeof b&&"undefined"!=typeof c&&(b.define("PublicaMundi.OpenLayers.Layer"),b.OpenLayers.Layer.WMS=b.Class(b.Layer,{initialize:function(a){b.Layer.prototype.initialize.call(this,a),this._map=null,this._type=null,this._layer=new c.layer.Tile({title:a.title,source:new c.source.TileWMS({url:a.url,params:a.params})})}}),b.registry.registerLayerType({layer:b.LayerType.WMS,framework:b.OpenLayers.Framework,type:"PublicaMundi.Layer.WMS",factory:b.OpenLayers.Layer.WMS}))}(window,window.PublicaMundi,ol),function(a,b,c){"undefined"!=typeof b&&"undefined"!=typeof c&&(b.define("PublicaMundi.OpenLayers.Layer"),b.OpenLayers.Layer.Tile=b.Class(b.Layer,{initialize:function(a){b.Layer.prototype.initialize.call(this,a),this._layer=new c.layer.Tile({title:a.title,source:new c.source.XYZ({url:a.url})});var d=[];if(a.url.indexOf("{s}")<0)d.push(a.url);else{var e=a.subdomains||"abc";b.isArray(e)||(e=e.split(""));for(var f=0;f<e.length;f++)d.push(a.url.replace("{s}",e[f]))}this._layer.getSource().setUrls(d)}}),b.registry.registerLayerType({layer:b.LayerType.TILE,framework:b.OpenLayers.Framework,type:"PublicaMundi.Layer.Tile",factory:b.OpenLayers.Layer.Tile}))}(window,window.PublicaMundi,ol),function(a,b,c){"undefined"!=typeof b&&"undefined"!=typeof c&&(b.define("PublicaMundi.OpenLayers.Layer"),b.OpenLayers.Layer.GeoJson=b.Class(b.Layer,{initialize:function(a){b.Layer.prototype.initialize.call(this,a),this._layer=new c.layer.Vector({title:a.title,source:new c.source.GeoJSON({projection:a.projection,url:a.url})})}}),b.registry.registerLayerType({layer:b.LayerType.GeoJSON,framework:b.OpenLayers.Framework,type:"PublicaMundi.Layer.GeoJson",factory:b.OpenLayers.Layer.GeoJson}),b.isDefined(b.Map)&&(b.Map.prototype.geoJSON=function(a){a.type=a.type||b.LayerType.GeoJSON,this.createLayer(a)}))}(window,window.PublicaMundi,ol);
//# sourceMappingURL=publicamundi.ol.js.map